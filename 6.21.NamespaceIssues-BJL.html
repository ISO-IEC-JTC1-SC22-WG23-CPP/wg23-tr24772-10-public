<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>parts/6.21.NamespaceIssues-BJL.md</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">parts/6.21.NamespaceIssues-BJL.md</h1>
</header>
<h2 id="namespace-issues-bjl">6.21 Namespace Issues [BJL]</h2>
<h3 id="applicability-to-language">6.21.1 Applicability to language</h3>
<p>The vulnerability described in ISO/IEC TR 24772-1:2019 clause 6.21 is restricted to the following cases:</p>
<ul>
<li><p>Overloading, where clause 6.20 applies;</p></li>
<li><p>Overriding, where clause 6.41 applies.</p></li>
</ul>
<p>In all other cases, C++ compilers are required to diagnose an ambiguity.</p>
<p><code>Note Start</code> Code examples: https://godbolt.org/z/erG5nPW19</p>
<p>210906: During the discussion the meaning of the vulnerability became clear:</p>
<blockquote>
<p>Can a maintainer add an overload that results in a program that still compiles but that has different behavior?</p>
</blockquote>
<ul>
<li><p>The answer is clearly yes. Overloads that are “better matches” can be added, and as long as they are found by lookup they will be selected. This is caused where the current best match also involves implicit conversions that are not present, or have a better rank, in the newly added function.</p></li>
<li><p>The addition of using directives, or the addition of functions to scopes that are later referred to in a using declaration can result in this change happening “at a distance”.</p></li>
<li><p>Argument Dependent Lookup (ADL), results in namespaces being searched, and should those namespaces have functions added to them they may be selected.</p></li>
</ul>
<p>The guideance is:</p>
<ul>
<li><p>fully qualify the names to remove any ambiguity of what function is being called if possible. An exception to this is user-defined literals (UDLs) which cannot be called with a fully qualified name.</p></li>
<li><p>don’t use using directives (except for the UDL case)</p></li>
<li><p>a namespace defining UDLs should only contain those definitions</p></li>
<li><p>What about avoiding implicit conversions when calling overloaded functions? However, implicit conversions are not the only way the compiler chooses between overloads:</p>
<ul>
<li>template vs non template</li>
<li>rvalue ref vs lvalue ref</li>
<li>const vs non-const</li>
</ul></li>
</ul>
<p><code>Note End</code></p>
<h3 id="guidance-to-language-users">6.21.2 Guidance to language users</h3>
<ul>
<li><p>Follow the guidance of clauses 6.20.2 and 6.41.2 as applicable.</p>
<ul>
<li><pre><code>  DCL60-CPP. Obey the one-definition rule (6.21)</code></pre></li>
<li><pre><code>  DCL40-C. Do not create incompatible declarations of the same</code></pre>
function or object (6.21)</li>
</ul></li>
</ul>
</body>
</html>
